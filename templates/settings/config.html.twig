<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ 'Sinch Conversations Settings'|xlt }}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { padding: 20px; background: #f8f9fa; }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="mb-4">{{ 'Sinch Conversations Settings'|xlt }}</h2>

        {% if success_message %}
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                {{ success_message|text }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        {% endif %}

        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">{{ 'API Configuration'|xlt }}</h5>
                <p class="text-muted">{{ 'Configure settings in Administration > Globals > Conversations'|xlt }}</p>

                <div class="mb-3">
                    <label class="form-label">{{ 'Sinch Project ID'|xlt }}</label>
                    <input type="text" class="form-control" value="{{ settings.project_id|attr }}" disabled>
                </div>

                <div class="mb-3">
                    <label class="form-label">{{ 'Sinch App ID'|xlt }}</label>
                    <input type="text" class="form-control" value="{{ settings.app_id|attr }}" disabled>
                </div>

                <div class="mb-3">
                    <label class="form-label">{{ 'API Region'|xlt }}</label>
                    <input type="text" class="form-control" value="{{ settings.region|attr }}" disabled>
                </div>

                <div class="mb-3">
                    <label class="form-label">{{ 'Default Channel'|xlt }}</label>
                    <input type="text" class="form-control" value="{{ settings.default_channel|attr }}" disabled>
                </div>

                <div class="mb-3">
                    <label class="form-label">{{ 'Clinic Name'|xlt }}</label>
                    <input type="text" class="form-control" value="{{ settings.clinic_name|attr }}" disabled>
                </div>

                <div class="mb-3">
                    <label class="form-label">{{ 'Clinic Phone'|xlt }}</label>
                    <input type="text" class="form-control" value="{{ settings.clinic_phone|attr }}" disabled>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-body">
                <h5 class="card-title">{{ 'API Connection Test'|xlt }}</h5>
                <p>{{ 'Test your Sinch API configuration to ensure connectivity.'|xlt }}</p>
                <button type="button" class="btn btn-primary" onclick="testConnection()">
                    {{ 'Test Connection'|xlt }}
                </button>
                <div id="testResult" class="mt-3"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    function testConnection() {
        const resultDiv = document.getElementById('testResult');
        resultDiv.innerHTML = '<div class="alert alert-info">Testing connection...</div>';

        fetch('settings.php?action=test&csrf_token={{ csrf_token|attr }}')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    resultDiv.innerHTML = '<div class="alert alert-success">' + data.message + '</div>';
                } else {
                    resultDiv.innerHTML = '<div class="alert alert-danger">Error: ' + data.message + '</div>';
                }
            })
            .catch(error => {
                resultDiv.innerHTML = '<div class="alert alert-danger">Connection failed: ' + error + '</div>';
            });
    }
    </script>
</body>
</html>
